!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JsonicDirective=e()}}((function(){var e={};Object.defineProperty(e,"__esModule",{value:!0}),e.Directive=void 0;const n=(e,n)=>{let l=("string"==typeof n.rules?n.rules.split(/\s*,\s*/):n.rules||[]).filter(e=>""!==e),t=n.name,o=n.open,i=n.close,r=n.action,s={},u="#D_open_"+t,d="#D_close_"+t,c=e.fixed(o),a=null==i?null:e.fixed(i);if(null!=c)throw new Error("Directive open token already in use: "+o);s[u]=o,null==a&&null!=i&&(s[d]=i),e.options({fixed:{token:s},error:{[t+"_close"]:null==i?null:"directive "+t+' close "'+i+'" without open "'+o+'"'},hint:{[t+"_close"]:null==i?null:`\nThe ${t} directive must start with the characters "${o}" and end\nwith the characters "${i}". The end characters "${i}" may not\nappear without the start characters "${o}" appearing first:\n"${o}...${i}".\n`}});let f=e.token.CA;c=e.fixed(o),a=null==i?null:e.fixed(i),l.forEach(n=>{e.rule(n,e=>(e.open({s:[c],p:t,n:{dr:1}}),null!=i&&(e.open([{s:[a],c:{n:{dr:0}},e:(e,n)=>n.t0.bad(t+"_close")},{s:[a],b:1}]),e.close({s:[a],b:1})),e))}),e.rule(t,e=>e.clear().bo(e=>e.node={}).open([{p:"val",n:null==i?{}:{pk:-1,il:0}}]).bc((...e)=>r(...e)).close(null!=i?[{s:[a]},{s:[f,a]}]:[]))};return e.Directive=n,n.defaults={rules:"val,pair,elem"},e}));